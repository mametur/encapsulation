<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf8" />
		<title>ColorCycler: class</title>

		<style>
			.color-cycler {
				height: 5em;
				width: 5em;
			}
		</style>
	</head>

	<body>
		<div id="user-interface">
			<form>
				<input type="number" min="0" value="2" name="x" />
				x
				<input type="number" min="0" value="2" name="y" />
				<input id="create-table-button" type="button" value="create table" name="createTable" />
			</form>
			<p>
				console log
				<code>currentCyclers</code>
				to see the state of each tile
			</p>
			<hr />
			<div id="root"></div>
		</div>

		<script id="data">
			let currentCyclers = [];
		</script>

		<script id="ColorCycler-class">
			class ColorCycler {
				state = {
					counter: 0,
				};
				get counter() {
					return this.state.counter;
				}
				color = ['black', 'blue', 'yellow', 'green'];
				constructor(x, y) {
					this.state.x = x;
					this.state.y = y;
				}

				renderTable() {
					const divEl = document.createElement('div');
					divEl.addEventListener('click', this.changeBackground.bind(this, divEl));
					divEl.classList.add('color-cycler');
					return divEl;
				}

				changeBackground(div) {
					if (this.counter >= this.color.length) {
						this.state.counter = 0;
					}
					div.style.background = this.color[this.state.counter];
					this.state.counter++;
				}
			}
		</script>

		<script id="handler">
			const createTableHandler = (event) => {
				const x = Number(event.target.form.x.value);
				const y = Number(event.target.form.y.value);

				if (x === 0 || y === 0) {
					return alert('Pass numbers bigger than zero');
				}

				// --- above here works
				const tableEl = document.createElement('table');
				//rows
				for (let i = 0; i < y; i++) {
					const trEl = document.createElement('tr');
					// columns or data
					for (let j = 0; j < x; j++) {
						const newTable = new ColorCycler(j, i);
						currentCyclers.push(newTable);
						const tdEl = document.createElement('td');
						tdEl.appendChild(newTable.renderTable());
						trEl.appendChild(tdEl);
					}
					tableEl.appendChild(trEl);
				}

				// create a new table with dimensions x, y
				//  create a new cycler for each table cell
				//  render the new cycler and append it to the cell
				// be sure to push each cycler instance to currentCyclers!

				// --- below here works

				const rootEl = document.getElementById('root');
				rootEl.innerHTML = '';
				rootEl.appendChild(tableEl);
			};
		</script>

		<script id="init">
			document.getElementById('create-table-button').addEventListener('click', createTableHandler);
		</script>
	</body>
</html>
